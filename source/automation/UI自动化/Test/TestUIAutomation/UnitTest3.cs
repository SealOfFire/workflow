using GRPCCommon.Protobuf;
using GRPCCommon.Protobuf.Common;
using Newtonsoft.Json.Linq;
using Newtonsoft.Json;
using UIAutomation.BrowserExtensions;
using static System.Net.Mime.MediaTypeNames;

namespace TestUIAutomation
{
    /// <summary>
    /// grpc²âÊÔ
    /// </summary>
    public class UnitTest3
    {
        //private readonly GrpcNativeMessageClient grpcClient;

        //public UnitTest3(GrpcNativeMessageClient grpcClient)
        //{
        //    this.grpcClient = grpcClient;
        //}

        [Fact]
        public void Test1()
        {
            //this.grpcClient.Connect(50001);

            //HoverRequest request1 = new HoverRequest
            //{
            //    Id= Guid.NewGuid().ToString(),
            //    MillisecondsTimeout=2000
            //};
            //request1.Position = new Position { X=11, Y=22 };
            //request1.Highlight = new Highlight { Color="#FF0000", Duration=2000 };

            ////this.nativeMessageClient.Write(processMessage);
            //HoverResponse? result1 = this.grpcClient.Hover(request1);

            //HoverRequest request2 = new HoverRequest
            //{
            //    Id= Guid.NewGuid().ToString(),
            //    MillisecondsTimeout=2000
            //};
            //request2.Position = new Position { X=33, Y=44 };
            //request2.Highlight = new Highlight { Color="#FF0000", Duration=2000 };
            //HoverResponse? result2 = this.grpcClient.Hover(request2);

            int debug = 0;
            debug++;
        }

        [Fact]
        public void Test2()
        {
            string text = " {\r\n        \"elementType\": 1,\r\n        \"cacheId\": \"\",\r\n        \"hasCacheId\": false,\r\n        \"values\": {},\r\n        \"boundingRectangle\": null,\r\n        \"parent\": null,\r\n        \"children\": [\r\n            {\r\n                \"elementType\": 1,\r\n                \"cacheId\": \"\",\r\n                \"hasCacheId\": false,\r\n                \"values\": {},\r\n                \"boundingRectangle\": null,\r\n                \"parent\": null,\r\n                \"children\": [\r\n                    {\r\n                        \"elementType\": 1,\r\n                        \"cacheId\": \"\",\r\n                        \"hasCacheId\": false,\r\n                        \"values\": {},\r\n                        \"boundingRectangle\": null,\r\n                        \"parent\": null,\r\n                        \"children\": [\r\n                            {\r\n                                \"elementType\": 1,\r\n                                \"cacheId\": \"\",\r\n                                \"hasCacheId\": false,\r\n                                \"values\": {},\r\n                                \"boundingRectangle\": null,\r\n                                \"parent\": null,\r\n                                \"children\": [\r\n                                    {\r\n                                        \"elementType\": 1,\r\n                                        \"cacheId\": \"\",\r\n                                        \"hasCacheId\": false,\r\n                                        \"values\": {},\r\n                                        \"boundingRectangle\": null,\r\n                                        \"parent\": null,\r\n                                        \"children\": [\r\n                                            {\r\n                                                \"elementType\": 1,\r\n                                                \"cacheId\": \"\",\r\n                                                \"hasCacheId\": false,\r\n                                                \"values\": {},\r\n                                                \"boundingRectangle\": null,\r\n                                                \"parent\": null,\r\n                                                \"children\": [\r\n                                                    {\r\n                                                        \"elementType\": 1,\r\n                                                        \"cacheId\": \"\",\r\n                                                        \"hasCacheId\": false,\r\n                                                        \"values\": {},\r\n                                                        \"boundingRectangle\": null,\r\n                                                        \"parent\": null,\r\n                                                        \"children\": [\r\n                                                            {\r\n                                                                \"elementType\": 1,\r\n                                                                \"cacheId\": \"\",\r\n                                                                \"hasCacheId\": false,\r\n                                                                \"values\": {},\r\n                                                                \"boundingRectangle\": null,\r\n                                                                \"parent\": null,\r\n                                                                \"children\": [],\r\n                                                                \"tag\": \"\",\r\n                                                                \"hasTag\": false,\r\n                                                                \"id\": \"\",\r\n                                                                \"hasId\": false,\r\n                                                                \"name\": \"×¨×¢\",\r\n                                                                \"hasName\": true,\r\n                                                                \"className\": \"NamedContainerAutomationPeer\",\r\n                                                                \"hasClassName\": true,\r\n                                                                \"title\": \"\",\r\n                                                                \"hasTitle\": false,\r\n                                                                \"href\": \"\",\r\n                                                                \"hasHref\": false,\r\n                                                                \"automationId\": \"\",\r\n                                                                \"hasAutomationId\": false,\r\n                                                                \"controlType\": 11,\r\n                                                                \"hasControlType\": true,\r\n                                                                \"value\": 0,\r\n                                                                \"hasValue\": false,\r\n                                                                \"type\": 0,\r\n                                                                \"hasType\": false,\r\n                                                                \"index\": 0,\r\n                                                                \"hasIndex\": false\r\n                                                            }\r\n                                                        ],\r\n                                                        \"tag\": \"\",\r\n                                                        \"hasTag\": false,\r\n                                                        \"id\": \"\",\r\n                                                        \"hasId\": false,\r\n                                                        \"name\": \"×¨×¢\",\r\n                                                        \"hasName\": true,\r\n                                                        \"className\": \"ListViewItem\",\r\n                                                        \"hasClassName\": true,\r\n                                                        \"title\": \"\",\r\n                                                        \"hasTitle\": false,\r\n                                                        \"href\": \"\",\r\n                                                        \"hasHref\": false,\r\n                                                        \"automationId\": \"\",\r\n                                                        \"hasAutomationId\": false,\r\n                                                        \"controlType\": 17,\r\n                                                        \"hasControlType\": true,\r\n                                                        \"value\": 0,\r\n                                                        \"hasValue\": false,\r\n                                                        \"type\": 0,\r\n                                                        \"hasType\": false,\r\n                                                        \"index\": 0,\r\n                                                        \"hasIndex\": false\r\n                                                    }\r\n                                                ],\r\n                                                \"tag\": \"\",\r\n                                                \"hasTag\": false,\r\n                                                \"id\": \"\",\r\n                                                \"hasId\": false,\r\n                                                \"name\": \"\",\r\n                                                \"hasName\": false,\r\n                                                \"className\": \"ListView\",\r\n                                                \"hasClassName\": true,\r\n                                                \"title\": \"\",\r\n                                                \"hasTitle\": false,\r\n                                                \"href\": \"\",\r\n                                                \"hasHref\": false,\r\n                                                \"automationId\": \"settingPagesList\",\r\n                                                \"hasAutomationId\": true,\r\n                                                \"controlType\": 16,\r\n                                                \"hasControlType\": true,\r\n                                                \"value\": 0,\r\n                                                \"hasValue\": false,\r\n                                                \"type\": 0,\r\n                                                \"hasType\": false,\r\n                                                \"index\": 0,\r\n                                                \"hasIndex\": false\r\n                                            }\r\n                                        ],\r\n                                        \"tag\": \"\",\r\n                                        \"hasTag\": false,\r\n                                        \"id\": \"\",\r\n                                        \"hasId\": false,\r\n                                        \"name\": \"\",\r\n                                        \"hasName\": false,\r\n                                        \"className\": \"ScrollViewer\",\r\n                                        \"hasClassName\": true,\r\n                                        \"title\": \"\",\r\n                                        \"hasTitle\": false,\r\n                                        \"href\": \"\",\r\n                                        \"hasHref\": false,\r\n                                        \"automationId\": \"\",\r\n                                        \"hasAutomationId\": false,\r\n                                        \"controlType\": 21,\r\n                                        \"hasControlType\": true,\r\n                                        \"value\": 0,\r\n                                        \"hasValue\": false,\r\n                                        \"type\": 0,\r\n                                        \"hasType\": false,\r\n                                        \"index\": 0,\r\n                                        \"hasIndex\": false\r\n                                    }\r\n                                ],\r\n                                \"tag\": \"\",\r\n                                \"hasTag\": false,\r\n                                \"id\": \"\",\r\n                                \"hasId\": false,\r\n                                \"name\": \"\",\r\n                                \"hasName\": false,\r\n                                \"className\": \"\",\r\n                                \"hasClassName\": false,\r\n                                \"title\": \"\",\r\n                                \"hasTitle\": false,\r\n                                \"href\": \"\",\r\n                                \"hasHref\": false,\r\n                                \"automationId\": \"PermanentNavigationView\",\r\n                                \"hasAutomationId\": true,\r\n                                \"controlType\": 6,\r\n                                \"hasControlType\": true,\r\n                                \"value\": 0,\r\n                                \"hasValue\": false,\r\n                                \"type\": 0,\r\n                                \"hasType\": false,\r\n                                \"index\": 0,\r\n                                \"hasIndex\": false\r\n                            }\r\n                        ],\r\n                        \"tag\": \"\",\r\n                        \"hasTag\": false,\r\n                        \"id\": \"\",\r\n                        \"hasId\": false,\r\n                        \"name\": \"ÉèÖÃ\",\r\n                        \"hasName\": true,\r\n                        \"className\": \"Windows.UI.Core.CoreWindow\",\r\n                        \"hasClassName\": true,\r\n                        \"title\": \"\",\r\n                        \"hasTitle\": false,\r\n                        \"href\": \"\",\r\n                        \"hasHref\": false,\r\n                        \"automationId\": \"\",\r\n                        \"hasAutomationId\": false,\r\n                        \"controlType\": 41,\r\n                        \"hasControlType\": true,\r\n                        \"value\": 0,\r\n                        \"hasValue\": false,\r\n                        \"type\": 0,\r\n                        \"hasType\": false,\r\n                        \"index\": 0,\r\n                        \"hasIndex\": false\r\n                    }\r\n                ],\r\n                \"tag\": \"\",\r\n                \"hasTag\": false,\r\n                \"id\": \"\",\r\n                \"hasId\": false,\r\n                \"name\": \"ÉèÖÃ\",\r\n                \"hasName\": true,\r\n                \"className\": \"ApplicationFrameWindow\",\r\n                \"hasClassName\": true,\r\n                \"title\": \"\",\r\n                \"hasTitle\": false,\r\n                \"href\": \"\",\r\n                \"hasHref\": false,\r\n                \"automationId\": \"\",\r\n                \"hasAutomationId\": false,\r\n                \"controlType\": 41,\r\n                \"hasControlType\": true,\r\n                \"value\": 0,\r\n                \"hasValue\": false,\r\n                \"type\": 0,\r\n                \"hasType\": false,\r\n                \"index\": 0,\r\n                \"hasIndex\": false\r\n            }\r\n        ],\r\n        \"tag\": \"\",\r\n        \"hasTag\": false,\r\n        \"id\": \"\",\r\n        \"hasId\": false,\r\n        \"name\": \"\",\r\n        \"hasName\": true,\r\n        \"className\": \"#32769\",\r\n        \"hasClassName\": true,\r\n        \"title\": \"\",\r\n        \"hasTitle\": false,\r\n        \"href\": \"\",\r\n        \"hasHref\": false,\r\n        \"automationId\": \"\",\r\n        \"hasAutomationId\": false,\r\n        \"controlType\": 21,\r\n        \"hasControlType\": true,\r\n        \"value\": 0,\r\n        \"hasValue\": false,\r\n        \"type\": 0,\r\n        \"hasType\": false,\r\n        \"index\": 0,\r\n        \"hasIndex\": false\r\n    }";
            GRPCCommon.Protobuf.Common.Attribute? jobject = JsonConvert.DeserializeObject<GRPCCommon.Protobuf.Common.Attribute>(text);

            int debug = 0;
            debug++;
        }

    }
}